import{a2 as fe,C as ee,v as G,$ as E,g as F,l as N,r as _,o as B,n as k,w as d,b as I,c as C,t as U,q as x,I as W,L as ae,M as te,a as n,H as A,e as O,a5 as ie,W as J,m as e,aa as ne,ab as re,F as K,a3 as X,h as y,i as D,ap as de,k as T,s as H,X as ue,u as oe,a1 as se,G as ce,j as me,K as pe,ae as _e,Z as be,E as ge,ag as le,f as ve,aQ as $e}from"./main-55335c70.js";import{u as we}from"./mail-sender-1c84da3c.js";import{_ as he,a as ye,b as Be}from"./SesDriver-3a94734a.js";const j=(b=!1)=>{const z=b?window.pinia.defineStore:fe,w=ee();return z({id:"installation",state:()=>({currentDataBaseData:{database_connection:"mysql",database_hostname:"127.0.0.1",database_port:"3306",database_name:null,database_username:null,database_password:null,app_url:window.location.origin}}),actions:{fetchInstallationRequirements(){return new Promise((r,o)=>{G.get("/api/v1/installation/requirements").then(t=>{r(t)}).catch(t=>{E(t),o(t)})})},fetchInstallationStep(){return new Promise((r,o)=>{G.get("/api/v1/installation/wizard-step").then(t=>{r(t)}).catch(t=>{E(t),o(t)})})},addInstallationStep(r){return new Promise((o,t)=>{G.post("/api/v1/installation/wizard-step",r).then(v=>{o(v)}).catch(v=>{E(v),t(v)})})},fetchInstallationPermissions(){return new Promise((r,o)=>{G.get("/api/v1/installation/permissions").then(t=>{r(t)}).catch(t=>{E(t),o(t)})})},fetchInstallationDatabase(r){return new Promise((o,t)=>{G.get("/api/v1/installation/database/config",{params:r}).then(v=>{o(v)}).catch(v=>{E(v),t(v)})})},addInstallationDatabase(r){return new Promise((o,t)=>{G.post("/api/v1/installation/database/config",r).then(v=>{o(v)}).catch(v=>{E(v),t(v)})})},addInstallationFinish(){return new Promise((r,o)=>{G.post("/api/v1/installation/finish").then(t=>{r(t)}).catch(t=>{E(t),o(t)})})},setInstallationDomain(r){return new Promise((o,t)=>{G.put("/api/v1/installation/set-domain",r).then(v=>{o(v)}).catch(v=>{E(v),t(v)})})},installationLogin(){return new Promise((r,o)=>{G.get("/sanctum/csrf-cookie").then(t=>{t&&G.post("/api/v1/installation/login").then(v=>{w.setSelectedCompany(v.data.company),r(v)}).catch(v=>{E(v),o(v)})})})},checkAutheticated(){return new Promise((r,o)=>{G.get("/api/v1/auth/check").then(t=>{r(t)}).catch(t=>{o(t)})})}}})()},qe={class:"w-full md:w-2/3"},Ie={class:"mb-6"},Se={key:0,class:"grid grid-flow-row grid-cols-3 p-3 border border-gray-200 lg:gap-24 sm:gap-4"},Ve={class:"col-span-2 text-sm"},ze={class:"text-right"},Me={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 bg-green-500 rounded-full"},De={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 bg-red-500 rounded-full"},Fe={key:1},ke={class:"col-span-2 text-sm"},Ce={class:"text-right"},Ue={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 bg-green-500 rounded-full"},xe={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 bg-red-500 rounded-full"},Pe={__name:"Step1RequirementsCheck",emits:["next"],setup(b,{emit:z}){const w=z,r=F(""),o=F(""),t=F(!1);F(!0);const v=j(),q=N(()=>{if(r.value){let g=!0;for(const a in r.value)return r.value[a]||(g=!1),r.value&&o.value.supported&&g}return!1});async function s(){var a,f,m,p;t.value=!0;const g=await v.fetchInstallationRequirements();g.data&&(r.value=(m=(f=(a=g==null?void 0:g.data)==null?void 0:a.requirements)==null?void 0:f.requirements)==null?void 0:m.php,o.value=(p=g==null?void 0:g.data)==null?void 0:p.phpSupportInfo)}function c(){t.value=!0,w("next"),t.value=!1}return(g,a)=>{const f=_("BaseIcon"),m=_("BaseButton"),p=_("BaseWizardStep");return B(),k(p,{title:g.$t("wizard.req.system_req"),description:g.$t("wizard.req.system_req_desc")},{default:d(()=>[I("div",qe,[I("div",Ie,[o.value?(B(),C("div",Se,[I("div",Ve,U(g.$t("wizard.req.php_req_version",{version:o.value.minimum})),1),I("div",ze,[x(U(o.value.current)+" ",1),o.value.supported?(B(),C("span",Me)):(B(),C("span",De))])])):W("",!0),r.value?(B(),C("div",Fe,[(B(!0),C(ae,null,te(r.value,($,M)=>(B(),C("div",{key:M,class:"grid grid-flow-row grid-cols-3 p-3 border border-gray-200 lg:gap-24 sm:gap-4"},[I("div",ke,U(M),1),I("div",Ce,[$?(B(),C("span",Ue)):(B(),C("span",xe))])]))),128))])):W("",!0)]),q.value?(B(),k(m,{key:0,onClick:c},{left:d($=>[n(f,{name:"ArrowRightIcon",class:A($.class)},null,8,["class"])]),default:d(()=>[x(U(g.$t("wizard.continue"))+" ",1)]),_:1})):W("",!0),r.value?W("",!0):(B(),k(m,{key:1,loading:t.value,disabled:t.value,onClick:s},{default:d(()=>[x(U(g.$t("wizard.req.check_req")),1)]),_:1},8,["loading","disabled"]))])]),_:1},8,["title","description"])}}},Ne={key:1,class:"relative"},Le={class:"grid grid-flow-row grid-cols-3 lg:gap-24 sm:gap-4"},Ge={class:"col-span-2 p-3"},We={class:"p-3 text-right"},Oe={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 rounded-full bg-green-500"},Ee={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 rounded-full bg-red-500"},Re={__name:"Step2PermissionCheck",emits:["next"],setup(b,{emit:z}){const w=z;let r=F(!1),o=F(!1),t=F([]);const{tm:v,t:q}=O(),s=j(),c=ie();J(()=>{g()});async function g(){r.value=!0;const f=await s.fetchInstallationPermissions();t.value=f.data.permissions.permissions,f.data&&f.data.permissions.errors&&setTimeout(()=>{c.openDialog({title:v("wizard.permissions.permission_confirm_title"),message:q("wizard.permissions.permission_confirm_desc"),yesLabel:"OK",noLabel:"Cancel",variant:"danger",hideNoButton:!1,size:"lg"}).then(m=>{m.data&&(r.value=!1)})},500),r.value=!1}function a(){o.value=!0,w("next"),o.value=!1}return(f,m)=>{const p=_("BaseContentPlaceholdersText"),$=_("BaseContentPlaceholdersBox"),M=_("BaseContentPlaceholders"),i=_("BaseIcon"),u=_("BaseButton"),V=_("BaseWizardStep");return B(),k(V,{title:f.$t("wizard.permissions.permissions"),description:f.$t("wizard.permissions.permission_desc")},{default:d(()=>[e(r)?(B(),k(M,{key:0},{default:d(()=>[(B(),C(ae,null,te(3,(h,l)=>I("div",{key:l,class:"grid grid-flow-row grid-cols-3 lg:gap-24 sm:gap-4 border border-gray-200"},[n(p,{lines:1,class:"col-span-4 p-3"})])),64)),n($,{rounded:!0,class:"mt-10",style:{width:"96px",height:"42px"}})]),_:1})):(B(),C("div",Ne,[(B(!0),C(ae,null,te(e(t),(h,l)=>(B(),C("div",{key:l,class:"border border-gray-200"},[I("div",Le,[I("div",Ge,U(h.folder),1),I("div",We,[h.isSet?(B(),C("span",Oe)):(B(),C("span",Ee)),I("span",null,U(h.permission),1)])])]))),128)),ne(n(u,{class:"mt-10",loading:e(o),disabled:e(o),onClick:a},{left:d(h=>[n(i,{name:"ArrowRightIcon",class:A(h.class)},null,8,["class"])]),default:d(()=>[x(" "+U(f.$t("wizard.continue")),1)]),_:1},8,["loading","disabled"]),[[re,!e(r)]])]))]),_:1},8,["title","description"])}}},Ae={class:"grid grid-cols-1 gap-5 md:grid-cols-2 lg:mb-6 md:mb-6"},Te={__name:"MysqlDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,default:!1}},emits:["submit-data","on-change-driver"],setup(b,{emit:z}){const w=b,r=z,o=K(["sqlite","mysql","pgsql"]),{t}=O(),v=X("utils"),q=j();J(()=>{for(const p in s.value)w.configData.hasOwnProperty(p)&&(s.value[p]=w.configData[p])});const s=N(()=>q.currentDataBaseData),c=p=>v.checkValidUrl(p),g={database_connection:{required:y.withMessage(t("validation.required"),D)},database_hostname:{required:y.withMessage(t("validation.required"),D)},database_port:{required:y.withMessage(t("validation.required"),D),numeric:de},database_name:{required:y.withMessage(t("validation.required"),D)},database_username:{required:y.withMessage(t("validation.required"),D)},app_url:{required:y.withMessage(t("validation.required"),D),isUrl:y.withMessage(t("validation.invalid_url"),c)}},a=T(g,s.value);function f(){if(a.value.$touch(),a.value.$invalid)return!0;r("submit-data",s.value)}function m(){a.value.database_connection.$touch(),r("on-change-driver",s.value.database_connection)}return(p,$)=>{const M=_("BaseInput"),i=_("BaseInputGroup"),u=_("BaseMultiselect"),V=_("BaseIcon"),h=_("BaseButton");return B(),C("form",{action:"",onSubmit:H(f,["prevent"])},[I("div",Ae,[n(i,{label:p.$t("wizard.database.app_url"),error:e(a).app_url.$error&&e(a).app_url.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.app_url,"onUpdate:modelValue":$[0]||($[0]=l=>s.value.app_url=l),invalid:e(a).app_url.$error,type:"text"},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(i,{label:p.$t("wizard.database.connection"),error:e(a).database_connection.$error&&e(a).database_connection.$errors[0].$message,required:""},{default:d(()=>[n(u,{modelValue:s.value.database_connection,"onUpdate:modelValue":[$[1]||($[1]=l=>s.value.database_connection=l),m],invalid:e(a).database_connection.$error,options:o,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),n(i,{label:p.$t("wizard.database.port"),error:e(a).database_port.$error&&e(a).database_port.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_port,"onUpdate:modelValue":$[2]||($[2]=l=>s.value.database_port=l),invalid:e(a).database_port.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(i,{label:p.$t("wizard.database.db_name"),error:e(a).database_name.$error&&e(a).database_name.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_name,"onUpdate:modelValue":$[3]||($[3]=l=>s.value.database_name=l),invalid:e(a).database_name.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(i,{label:p.$t("wizard.database.username"),error:e(a).database_username.$error&&e(a).database_username.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_username,"onUpdate:modelValue":$[4]||($[4]=l=>s.value.database_username=l),invalid:e(a).database_username.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(i,{label:p.$t("wizard.database.password")},{default:d(()=>[n(M,{modelValue:s.value.database_password,"onUpdate:modelValue":$[5]||($[5]=l=>s.value.database_password=l),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),n(i,{label:p.$t("wizard.database.host"),error:e(a).database_hostname.$error&&e(a).database_hostname.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_hostname,"onUpdate:modelValue":$[6]||($[6]=l=>s.value.database_hostname=l),invalid:e(a).database_hostname.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),n(h,{type:"submit",class:"mt-4",loading:b.isSaving,disabled:b.isSaving},{left:d(l=>[b.isSaving?W("",!0):(B(),k(V,{key:0,name:"SaveIcon",class:A(l.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(p.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)}}},je={class:"grid grid-cols-1 gap-5 md:grid-cols-2 lg:mb-6 md:mb-6"},Ye={__name:"PgsqlDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(b,{emit:z}){const w=b,r=z,o=K(["sqlite","mysql","pgsql"]),{t}=O(),v=X("utils"),q=j(),s=N(()=>q.currentDataBaseData);J(()=>{for(const p in s.value)w.configData.hasOwnProperty(p)&&(s.value[p]=w.configData[p])});const c=p=>v.checkValidUrl(p),g={database_connection:{required:y.withMessage(t("validation.required"),D)},database_hostname:{required:y.withMessage(t("validation.required"),D)},database_port:{required:y.withMessage(t("validation.required"),D),numeric:de},database_name:{required:y.withMessage(t("validation.required"),D)},database_username:{required:y.withMessage(t("validation.required"),D)},app_url:{required:y.withMessage(t("validation.required"),D),isUrl:y.withMessage(t("validation.invalid_url"),c)}},a=T(g,s.value);function f(){if(a.value.$touch(),a.value.$invalid)return!0;r("submit-data",s.value)}function m(){a.value.database_connection.$touch(),r("on-change-driver",s.value.database_connection)}return(p,$)=>{const M=_("BaseInput"),i=_("BaseInputGroup"),u=_("BaseMultiselect"),V=_("BaseIcon"),h=_("BaseButton");return B(),C("form",{action:"",onSubmit:H(f,["prevent"])},[I("div",je,[n(i,{label:p.$t("wizard.database.app_url"),"content-loading":b.isFetchingInitialData,error:e(a).app_url.$error&&e(a).app_url.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.app_url,"onUpdate:modelValue":$[0]||($[0]=l=>s.value.app_url=l),"content-loading":b.isFetchingInitialData,invalid:e(a).app_url.$error,type:"text"},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.connection"),"content-loading":b.isFetchingInitialData,error:e(a).database_connection.$error&&e(a).database_connection.$errors[0].$message,required:""},{default:d(()=>[n(u,{modelValue:s.value.database_connection,"onUpdate:modelValue":[$[1]||($[1]=l=>s.value.database_connection=l),m],"content-loading":b.isFetchingInitialData,invalid:e(a).database_connection.$error,options:o,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.port"),"content-loading":b.isFetchingInitialData,error:e(a).database_port.$error&&e(a).database_port.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_port,"onUpdate:modelValue":$[2]||($[2]=l=>s.value.database_port=l),"content-loading":b.isFetchingInitialData,invalid:e(a).database_port.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.db_name"),"content-loading":b.isFetchingInitialData,error:e(a).database_name.$error&&e(a).database_name.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_name,"onUpdate:modelValue":$[3]||($[3]=l=>s.value.database_name=l),"content-loading":b.isFetchingInitialData,invalid:e(a).database_name.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.username"),"content-loading":b.isFetchingInitialData,error:e(a).database_username.$error&&e(a).database_username.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_username,"onUpdate:modelValue":$[4]||($[4]=l=>s.value.database_username=l),"content-loading":b.isFetchingInitialData,invalid:e(a).database_username.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),n(i,{"content-loading":b.isFetchingInitialData,label:p.$t("wizard.database.password")},{default:d(()=>[n(M,{modelValue:s.value.database_password,"onUpdate:modelValue":$[5]||($[5]=l=>s.value.database_password=l),"content-loading":b.isFetchingInitialData,type:"password"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),n(i,{label:p.$t("wizard.database.host"),"content-loading":b.isFetchingInitialData,error:e(a).database_hostname.$error&&e(a).database_hostname.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_hostname,"onUpdate:modelValue":$[6]||($[6]=l=>s.value.database_hostname=l),"content-loading":b.isFetchingInitialData,invalid:e(a).database_hostname.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),ne(n(h,{"content-loading":b.isFetchingInitialData,type:"submit",class:"mt-4",loading:b.isSaving,disabled:b.isSaving},{left:d(l=>[b.isSaving?W("",!0):(B(),k(V,{key:0,name:"SaveIcon",class:A(l.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(p.$t("wizard.save_cont")),1)]),_:1},8,["content-loading","loading","disabled"]),[[re,!b.isFetchingInitialData]])],32)}}},Ze={class:"grid grid-cols-1 gap-5 md:grid-cols-2 lg:mb-6 md:mb-6"},Ke={__name:"SqliteDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(b,{emit:z}){const w=b,r=z,o=K(["sqlite","mysql","pgsql"]),{t}=O(),v=X("utils"),q=j(),s=N(()=>q.currentDataBaseData);J(()=>{for(const p in s.value)w.configData.hasOwnProperty(p)&&(s.value[p]=w.configData[p])});const c=p=>v.checkValidUrl(p),g={database_connection:{required:y.withMessage(t("validation.required"),D)},database_name:{required:y.withMessage(t("validation.required"),D)},app_url:{required:y.withMessage(t("validation.required"),D),isUrl:y.withMessage(t("validation.invalid_url"),c)}},a=T(g,s.value);function f(){if(a.value.$touch(),a.value.$invalid)return!0;r("submit-data",s.value)}function m(){a.value.database_connection.$touch(),r("on-change-driver",s.value.database_connection)}return(p,$)=>{const M=_("BaseInput"),i=_("BaseInputGroup"),u=_("BaseMultiselect"),V=_("BaseIcon"),h=_("BaseButton");return B(),C("form",{action:"",onSubmit:H(f,["prevent"])},[I("div",Ze,[n(i,{label:p.$t("wizard.database.app_url"),"content-loading":b.isFetchingInitialData,error:e(a).app_url.$error&&e(a).app_url.$errors[0].$message,required:""},{default:d(()=>[n(M,{modelValue:s.value.app_url,"onUpdate:modelValue":$[0]||($[0]=l=>s.value.app_url=l),"content-loading":b.isFetchingInitialData,invalid:e(a).app_url.$error,type:"text"},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.connection"),"content-loading":b.isFetchingInitialData,error:e(a).database_connection.$error&&e(a).database_connection.$errors[0].$message,required:""},{default:d(()=>[n(u,{modelValue:s.value.database_connection,"onUpdate:modelValue":[$[1]||($[1]=l=>s.value.database_connection=l),m],"content-loading":b.isFetchingInitialData,invalid:e(a).database_connection.$error,options:o,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["label","content-loading","error"]),n(i,{label:p.$t("wizard.database.db_path"),error:e(a).database_name.$error&&e(a).database_name.$errors[0].$message,"content-loading":b.isFetchingInitialData,required:""},{default:d(()=>[n(M,{modelValue:s.value.database_name,"onUpdate:modelValue":$[2]||($[2]=l=>s.value.database_name=l),"content-loading":b.isFetchingInitialData,invalid:e(a).database_name.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"])]),ne(n(h,{"content-loading":b.isFetchingInitialData,type:"submit",class:"mt-4",loading:b.isSaving,disabled:b.isSaving},{left:d(l=>[b.isSaving?W("",!0):(B(),k(V,{key:0,name:"SaveIcon",class:A(l.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(p.$t("wizard.save_cont")),1)]),_:1},8,["content-loading","loading","disabled"]),[[re,!b.isFetchingInitialData]])],32)}}},He={components:{Mysql:Te,Pgsql:Ye,Sqlite:Ke},emits:["next"],setup(b,{emit:z}){const w=F("mysql"),r=F(!1),{t:o}=O(),t=oe(),v=j(),q=N(()=>v.currentDataBaseData);async function s(g){let a={connection:g};const f=await v.fetchInstallationDatabase(a);f.data.success&&(q.value.database_connection=f.data.config.database_connection),g==="sqlite"?q.value.database_name=f.data.config.database_name:q.value.database_name=null}async function c(g){r.value=!0;try{let a=await v.addInstallationDatabase(g);if(r.value=!1,a.data.success){await v.addInstallationFinish(),z("next",3),t.showNotification({type:"success",message:o("wizard.success."+a.data.success)});return}else if(a.data.error){if(a.data.requirement){t.showNotification({type:"error",message:o("wizard.errors."+a.data.error,{version:a.data.requirement.minimum,name:g.value.database_connection})});return}t.showNotification({type:"error",message:o("wizard.errors."+a.data.error)})}else a.data.errors?t.showNotification({type:"error",message:a.data.errors[0]}):a.data.error_message&&t.showNotification({type:"error",message:a.data.error_message})}catch{t.showNotification({type:"error",message:o("validation.something_went_wrong")}),r.value=!1}finally{r.value=!1}}return{databaseData:q,database_connection:w,isSaving:r,getDatabaseConfig:s,next:c}}};function Je(b,z,w,r,o,t){const v=_("BaseWizardStep");return B(),k(v,{title:b.$t("wizard.database.database"),description:b.$t("wizard.database.desc"),"step-container":"w-full p-8 mb-8 bg-white border border-gray-200 border-solid rounded md:w-full"},{default:d(()=>[(B(),k(se(r.databaseData.database_connection),{"config-data":r.databaseData,"is-saving":r.isSaving,onOnChangeDriver:r.getDatabaseConfig,onSubmitData:r.next},null,40,["config-data","is-saving","onOnChangeDriver","onSubmitData"]))]),_:1},8,["title","description"])}const Qe=ue(He,[["render",Je]]),Xe={class:"w-full md:w-2/3"},ea=I("p",{class:"mt-4 mb-0 text-sm text-gray-600"},"Notes:",-1),aa=I("ul",{class:"w-full text-gray-600 list-disc list-inside"},[I("li",{class:"text-sm leading-8"},[x(" App domain should not contain "),I("b",{class:"inline-block px-1 bg-gray-100 rounded-sm"},"https://"),x(" or "),I("b",{class:"inline-block px-1 bg-gray-100 rounded-sm"},"http"),x(" in front of the domain. ")]),I("li",{class:"text-sm leading-8"},[x(" If you're accessing the website on a different port, please mention the port. For example: "),I("b",{class:"inline-block px-1 bg-gray-100"},"localhost:8080")])],-1),ta={__name:"Step4VerifyDomain",emits:["next"],setup(b,{emit:z}){const w=z,r=K({app_domain:window.location.origin.replace(/(^\w+:|^)\/\//,"")}),o=F(!1),{t}=O(),v=X("utils"),q=m=>v.checkValidDomainUrl(m),s=j(),c=oe(),g={app_domain:{required:y.withMessage(t("validation.required"),D),isUrl:y.withMessage(t("validation.invalid_domain_url"),q)}},a=T(g,N(()=>r));async function f(){if(a.value.$touch(),a.value.$invalid)return!0;o.value=!0;try{await s.setInstallationDomain(r),await s.installationLogin(),(await s.checkAutheticated()).data&&w("next",4),o.value=!1}catch{c.showNotification({type:"error",message:t("wizard.verify_domain.failed")}),o.value=!1}}return(m,p)=>{const $=_("BaseInput"),M=_("BaseInputGroup"),i=_("BaseButton"),u=_("BaseWizardStep");return B(),k(u,{title:m.$t("wizard.verify_domain.title"),description:m.$t("wizard.verify_domain.desc")},{default:d(()=>[I("div",Xe,[n(M,{label:m.$t("wizard.verify_domain.app_domain"),error:e(a).app_domain.$error&&e(a).app_domain.$errors[0].$message,required:""},{default:d(()=>[n($,{modelValue:r.app_domain,"onUpdate:modelValue":p[0]||(p[0]=V=>r.app_domain=V),invalid:e(a).app_domain.$error,type:"text",onInput:p[1]||(p[1]=V=>e(a).app_domain.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),ea,aa,n(i,{loading:o.value,disabled:o.value,class:"mt-8",onClick:f},{default:d(()=>[x(U(m.$t("wizard.verify_domain.verify_now")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["title","description"])}}},na={class:"p-4 sm:p-6 my-2"},R="settings.mail_sender",ra={__name:"Step5EmailConfig",emits:["next"],setup(b,{emit:z}){const w=we(),{t:r}=O();F(null),X("utils");let o=F(!1);const t=z,v=N(()=>{switch(w.currentMailSender.driver){case"smtp":return Be;case"mail":return!1;case"sendmail":return!1;case"mailgun":return ye;case"ses":return he;default:return!1}}),q=a=>{if(a==""||a===null)return!0;const f=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;return a.split(",").every($=>f.test($))},s=N(()=>({name:{required:y.withMessage(r("validation.required"),D),minLength:y.withMessage(r("validation.name_min_length",{count:3}),ce(3))},from_name:{required:y.withMessage(r("validation.required"),D)},from_address:{required:y.withMessage(r("validation.required"),D),email:y.withMessage(r("validation.email_incorrect"),me)},cc:{multiEmail:y.withMessage(r("validation.email_incorrect"),q)},bcc:{multiEmail:y.withMessage(r("validation.email_incorrect"),q)},driver:{required:y.withMessage(r("validation.required"),D)}})),c=T(s,N(()=>w.currentMailSender));async function g(){if(c.value.$touch(),c.value.$invalid)return!0;try{let a={...w.currentMailSender,is_default:!0};await w.addMailSender(a),o.value=!0,t("next"),o.value=!1}catch{return o.value=!1,!0}}return J(async()=>{await w.fetchMailDrivers()}),(a,f)=>{const m=_("BaseInput"),p=_("BaseInputGroup"),$=_("BaseMultiselect"),M=_("BaseInputGrid"),i=_("BaseDivider"),u=_("BaseIcon"),V=_("BaseButton"),h=_("BaseWizardStep");return B(),k(h,{title:a.$t("wizard.mail.mail_config"),description:a.$t("wizard.mail.mail_config_desc")},{default:d(()=>[I("form",{action:"",onSubmit:H(g,["prevent"])},[I("div",na,[n(M,null,{default:d(()=>[n(p,{label:a.$t(`${R}.name`),error:e(c).name.$error&&e(c).name.$errors[0].$message,"help-text":a.$t(`${R}.name_help`),required:""},{default:d(()=>[n(m,{modelValue:e(w).currentMailSender.name,"onUpdate:modelValue":f[0]||(f[0]=l=>e(w).currentMailSender.name=l),modelModifiers:{trim:!0},invalid:e(c).name.$error,type:"text",onInput:f[1]||(f[1]=l=>e(c).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error","help-text"]),n(p,{label:a.$t(`${R}.from_name`),error:e(c).from_name.$error&&e(c).from_name.$errors[0].$message,required:""},{default:d(()=>[n(m,{modelValue:e(w).currentMailSender.from_name,"onUpdate:modelValue":f[2]||(f[2]=l=>e(w).currentMailSender.from_name=l),invalid:e(c).from_name.$error,type:"text",onInput:f[3]||(f[3]=l=>e(c).from_name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(p,{label:a.$t(`${R}.from_address`),error:e(c).from_address.$error&&e(c).from_address.$errors[0].$message,required:""},{default:d(()=>[n(m,{modelValue:e(w).currentMailSender.from_address,"onUpdate:modelValue":f[4]||(f[4]=l=>e(w).currentMailSender.from_address=l),invalid:e(c).from_address.$error,type:"text",onInput:f[5]||(f[5]=l=>e(c).from_address.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(p,{label:a.$t(`${R}.cc`),error:e(c).cc.$error&&e(c).cc.$errors[0].$message,"help-text":a.$t(`${R}.email_list`)},{default:d(()=>[n(m,{modelValue:e(w).currentMailSender.cc,"onUpdate:modelValue":f[6]||(f[6]=l=>e(w).currentMailSender.cc=l),invalid:e(c).cc.$error,type:"text",onInput:f[7]||(f[7]=l=>e(c).cc.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error","help-text"]),n(p,{label:a.$t(`${R}.bcc`),error:e(c).bcc.$error&&e(c).bcc.$errors[0].$message,"help-text":a.$t(`${R}.email_list`)},{default:d(()=>[n(m,{modelValue:e(w).currentMailSender.bcc,"onUpdate:modelValue":f[8]||(f[8]=l=>e(w).currentMailSender.bcc=l),invalid:e(c).bcc.$error,type:"text",onInput:f[9]||(f[9]=l=>e(c).bcc.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error","help-text"]),n(p,{label:a.$t(`${R}.driver`),error:e(c).driver.$error&&e(c).driver.$errors[0].$message,required:""},{default:d(()=>[n($,{modelValue:e(w).currentMailSender.driver,"onUpdate:modelValue":f[10]||(f[10]=l=>e(w).currentMailSender.driver=l),options:e(w).mail_drivers,"can-deselect":!1,invalid:e(c).driver.$error},null,8,["modelValue","options","invalid"])]),_:1},8,["label","error"]),(B(),k(se(v.value),{"mail-sender-store":e(w)},null,8,["mail-sender-store"]))]),_:1}),n(i,{class:"my-4"}),n(V,{loading:e(o),disabled:e(o),variant:"primary",type:"submit"},{left:d(l=>[e(o)?W("",!0):(B(),k(u,{key:0,name:"SaveIcon",class:A(l.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(a.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])])],32)]),_:1},8,["title","description"])}}},oa={class:"grid grid-cols-1 mb-4 md:grid-cols-2 md:mb-6"},sa={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},la={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},ia={__name:"Step6AccountSettings",emits:["next"],setup(b,{emit:z}){const w=z;let r=F(!1);const o=F(!1),t=F(!1);let v=F(""),q=F(null);const s=pe(),c=ee(),{t:g}=O(),a=N(()=>s.userForm),f=N(()=>({userForm:{name:{required:y.withMessage(g("validation.required"),D)},email:{required:y.withMessage(g("validation.required"),D),email:y.withMessage(g("validation.email_incorrect"),me)},password:{required:y.withMessage(g("validation.required"),D),minLength:y.withMessage(g("validation.password_min_length",{count:8}),ce(8))},confirm_password:{required:y.withMessage(g("validation.required"),_e(s.userForm.password)),sameAsPassword:y.withMessage(g("validation.password_incorrect"),be(s.userForm.password))}}})),m=T(f,N(()=>s));function p(i,u){q.value=u}function $(){q.value=null}async function M(){if(m.value.userForm.$touch(),m.value.userForm.$invalid)return!0;r.value=!0;let i=await s.updateCurrentUser(a.value);if(r.value=!1,i.data.data){if(q.value){let V=new FormData;V.append("admin_avatar",q.value),await s.uploadAvatar(V)}const u=i.data.data.companies[0];await c.setSelectedCompany(u),w("next",6)}}return(i,u)=>{const V=_("BaseFileUploader"),h=_("BaseInputGroup"),l=_("BaseInput"),L=_("EyeOffIcon"),Y=_("EyeIcon"),Z=_("BaseIcon"),Q=_("BaseButton"),P=_("BaseWizardStep");return B(),k(P,{title:i.$t("wizard.account_info"),description:i.$t("wizard.account_info_desc")},{default:d(()=>[I("form",{action:"",onSubmit:H(M,["prevent"])},[I("div",oa,[n(h,{label:i.$tc("settings.account_settings.profile_picture")},{default:d(()=>[n(V,{avatar:!0,"preview-image":e(v),onChange:p,onRemove:$},null,8,["preview-image"])]),_:1},8,["label"])]),I("div",sa,[n(h,{label:i.$t("wizard.name"),error:e(m).userForm.name.$error&&e(m).userForm.name.$errors[0].$message,required:""},{default:d(()=>[n(l,{modelValue:a.value.name,"onUpdate:modelValue":u[0]||(u[0]=S=>a.value.name=S),modelModifiers:{trim:!0},invalid:e(m).userForm.name.$error,type:"text",name:"name",onInput:u[1]||(u[1]=S=>e(m).userForm.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(h,{label:i.$t("wizard.email"),error:e(m).userForm.email.$error&&e(m).userForm.email.$errors[0].$message,required:""},{default:d(()=>[n(l,{modelValue:a.value.email,"onUpdate:modelValue":u[2]||(u[2]=S=>a.value.email=S),modelModifiers:{trim:!0},invalid:e(m).userForm.email.$error,type:"text",name:"email",onInput:u[3]||(u[3]=S=>e(m).userForm.email.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),I("div",la,[n(h,{label:i.$t("wizard.password"),error:e(m).userForm.password.$error&&e(m).userForm.password.$errors[0].$message,required:""},{default:d(()=>[n(l,{modelValue:a.value.password,"onUpdate:modelValue":u[6]||(u[6]=S=>a.value.password=S),modelModifiers:{trim:!0},invalid:e(m).userForm.password.$error,type:o.value?"text":"password",name:"password",onInput:u[7]||(u[7]=S=>e(m).userForm.password.$touch())},{right:d(()=>[o.value?(B(),k(L,{key:0,class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:u[4]||(u[4]=S=>o.value=!o.value)})):(B(),k(Y,{key:1,class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:u[5]||(u[5]=S=>o.value=!o.value)}))]),_:1},8,["modelValue","invalid","type"])]),_:1},8,["label","error"]),n(h,{label:i.$t("wizard.confirm_password"),error:e(m).userForm.confirm_password.$error&&e(m).userForm.confirm_password.$errors[0].$message,required:""},{default:d(()=>[n(l,{modelValue:a.value.confirm_password,"onUpdate:modelValue":u[10]||(u[10]=S=>a.value.confirm_password=S),modelModifiers:{trim:!0},invalid:e(m).userForm.confirm_password.$error,type:t.value?"text":"password",name:"confirm_password",onInput:u[11]||(u[11]=S=>e(m).userForm.confirm_password.$touch())},{right:d(()=>[t.value?(B(),k(Z,{key:0,name:"EyeOffIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:u[8]||(u[8]=S=>t.value=!t.value)})):(B(),k(Z,{key:1,name:"EyeIcon",class:"w-5 h-5 mr-1 text-gray-500 cursor-pointer",onClick:u[9]||(u[9]=S=>t.value=!t.value)}))]),_:1},8,["modelValue","invalid","type"])]),_:1},8,["label","error"])]),n(Q,{loading:e(r),disabled:e(r),class:"mt-4"},{left:d(S=>[e(r)?W("",!0):(B(),k(Z,{key:0,name:"SaveIcon",class:A(S.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(i.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)]),_:1},8,["title","description"])}}},da={class:"grid grid-cols-1 mb-4 md:grid-cols-2 md:mb-6"},ua={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ca={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ma={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},pa={__name:"Step7CompanyInfo",emits:["next"],setup(b,{emit:z}){const w=z;let r=F(!1),o=F(!1);const{t}=O();let v=F(null),q=F(null),s=F(null);const c=K({name:null,address:{address_street_1:"",address_street_2:"",website:"",country_id:null,state:"",city:"",phone:"",zip:""}}),g=ee(),a=ge();J(async()=>{var i;r.value=!0,await a.fetchCountries(),r.value=!1,c.address.country_id=(i=a.countries.find(u=>u.code=="US"))==null?void 0:i.id});const f={companyForm:{name:{required:y.withMessage(t("validation.required"),D)},address:{country_id:{required:y.withMessage(t("validation.required"),D)},address_street_1:{maxLength:y.withMessage(t("validation.address_maxlength",{count:255}),le(255))},address_street_2:{maxLength:y.withMessage(t("validation.address_maxlength",{count:255}),le(255))}}}},m=T(f,{companyForm:c});function p(i,u,V,h){s.value=h.name,q.value=u}function $(){q.value=null}async function M(){if(m.value.companyForm.$touch(),m.value.$invalid)return!0;if(o.value=!0,g.updateCompany(c)){if(q.value){let u=new FormData;u.append("company_logo",JSON.stringify({name:s.value,data:q.value})),await g.updateCompanyLogo(u)}o.value=!1,w("next",7)}}return(i,u)=>{const V=_("BaseFileUploader"),h=_("BaseInputGroup"),l=_("BaseInput"),L=_("BaseMultiselect"),Y=_("BaseTextarea"),Z=_("BaseIcon"),Q=_("BaseButton"),P=_("BaseWizardStep");return B(),k(P,{title:i.$t("wizard.company_info"),description:i.$t("wizard.company_info_desc"),"step-container":"bg-white border border-gray-200 border-solid mb-8 md:w-full p-8 rounded w-full"},{default:d(()=>[I("form",{action:"",onSubmit:H(M,["prevent"])},[I("div",da,[n(h,{label:i.$tc("settings.company_info.company_logo")},{default:d(()=>[n(V,{base64:"","preview-image":e(v),onChange:p,onRemove:$},null,8,["preview-image"])]),_:1},8,["label"])]),I("div",ua,[n(h,{label:i.$t("wizard.company_name"),error:e(m).companyForm.name.$error&&e(m).companyForm.name.$errors[0].$message,required:""},{default:d(()=>[n(l,{modelValue:c.name,"onUpdate:modelValue":u[0]||(u[0]=S=>c.name=S),modelModifiers:{trim:!0},invalid:e(m).companyForm.name.$error,type:"text",name:"name",onInput:u[1]||(u[1]=S=>e(m).companyForm.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(h,{label:i.$t("wizard.country"),error:e(m).companyForm.address.country_id.$error&&e(m).companyForm.address.country_id.$errors[0].$message,"content-loading":e(r),required:""},{default:d(()=>[n(L,{modelValue:c.address.country_id,"onUpdate:modelValue":u[2]||(u[2]=S=>c.address.country_id=S),label:"name",invalid:e(m).companyForm.address.country_id.$error,options:e(a).countries,"value-prop":"id","can-deselect":!1,"can-clear":!1,"content-loading":e(r),placeholder:i.$t("general.select_country"),searchable:"","track-by":"name"},null,8,["modelValue","invalid","options","content-loading","placeholder"])]),_:1},8,["label","error","content-loading"])]),I("div",ca,[n(h,{label:i.$t("wizard.state")},{default:d(()=>[n(l,{modelValue:c.address.state,"onUpdate:modelValue":u[3]||(u[3]=S=>c.address.state=S),name:"state",type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),n(h,{label:i.$t("wizard.city")},{default:d(()=>[n(l,{modelValue:c.address.city,"onUpdate:modelValue":u[4]||(u[4]=S=>c.address.city=S),name:"city",type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]),I("div",ma,[I("div",null,[n(h,{label:i.$t("wizard.address"),error:e(m).companyForm.address.address_street_1.$error&&e(m).companyForm.address.address_street_1.$errors[0].$message},{default:d(()=>[n(Y,{modelValue:c.address.address_street_1,"onUpdate:modelValue":u[5]||(u[5]=S=>c.address.address_street_1=S),modelModifiers:{trim:!0},invalid:e(m).companyForm.address.address_street_1.$error,placeholder:i.$t("general.street_1"),name:"billing_street1",rows:"2",onInput:u[6]||(u[6]=S=>e(m).companyForm.address.address_street_1.$touch())},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["label","error"]),n(h,{error:e(m).companyForm.address.address_street_2.$error&&e(m).companyForm.address.address_street_2.$errors[0].$message,class:"mt-1 lg:mt-2 md:mt-2"},{default:d(()=>[n(Y,{modelValue:c.address.address_street_2,"onUpdate:modelValue":u[7]||(u[7]=S=>c.address.address_street_2=S),invalid:e(m).companyForm.address.address_street_2.$error,placeholder:i.$t("general.street_2"),name:"billing_street2",rows:"2",onInput:u[8]||(u[8]=S=>e(m).companyForm.address.address_street_2.$touch())},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error"])]),I("div",null,[n(h,{label:i.$t("wizard.zip_code")},{default:d(()=>[n(l,{modelValue:c.address.zip,"onUpdate:modelValue":u[9]||(u[9]=S=>c.address.zip=S),modelModifiers:{trim:!0},type:"text",name:"zip"},null,8,["modelValue"])]),_:1},8,["label"]),n(h,{label:i.$t("wizard.phone"),class:"mt-4"},{default:d(()=>[n(l,{modelValue:c.address.phone,"onUpdate:modelValue":u[10]||(u[10]=S=>c.address.phone=S),modelModifiers:{trim:!0},type:"text",name:"phone"},null,8,["modelValue"])]),_:1},8,["label"])])]),n(Q,{loading:e(o),disabled:e(o),class:"mt-4"},{left:d(S=>[e(o)?W("",!0):(B(),k(Z,{key:0,name:"SaveIcon",class:A(S.class)},null,8,["class"]))]),default:d(()=>[x(" "+U(i.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)]),_:1},8,["title","description"])}}},ga={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},va={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},fa={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},_a={__name:"Step8CompanyPreferences",emits:["next"],setup(b,{emit:z}){const w=z,r=F(!1);let o=F(!1),t=K({currency:1,language:"en",carbon_date_format:"d M Y",time_zone:"UTC",fiscal_year:"1-12"});const{tm:v,t:q}=O(),s=ve();o.value=!0,K([{title:v("settings.customization.invoices.allow"),value:"allow"},{title:v("settings.customization.invoices.disable_on_invoice_partial_paid"),value:"disable_on_invoice_partial_paid"},{title:v("settings.customization.invoices.disable_on_invoice_paid"),value:"disable_on_invoice_paid"},{title:v("settings.customization.invoices.disable_on_invoice_sent"),value:"disable_on_invoice_sent"}]);const c=ie(),g=ge(),a=ee(),f=pe(),m=oe();let p={key:"fiscal_years"},$={key:"languages"};o.value=!0,Promise.all([g.fetchCurrencies(),g.fetchDateFormats(),g.fetchTimeZones(),g.fetchCountries(),g.fetchConfig(p),g.fetchConfig($)]).then(([V])=>{o.value=!1});const M=N(()=>({currentPreferences:{currency:{required:y.withMessage(q("validation.required"),D)},language:{required:y.withMessage(q("validation.required"),D)},carbon_date_format:{required:y.withMessage(q("validation.required"),D)},time_zone:{required:y.withMessage(q("validation.required"),D)},fiscal_year:{required:y.withMessage(q("validation.required"),D)}}})),i=T(M,{currentPreferences:t});async function u(){if(i.value.currentPreferences.$touch(),i.value.$invalid)return!0;c.openDialog({title:q("general.do_you_wish_to_continue"),message:q("wizard.currency_set_alert"),yesLabel:q("general.ok"),noLabel:q("general.cancel"),variant:"danger",size:"lg",hideNoButton:!1}).then(async V=>{if(V){let h={settings:{...t}};r.value=!0,delete h.settings.discount_per_item;let l=await a.updateCompanySettings({data:h});if(l.data){r.value=!1;let L={settings:{language:t.language}};(await f.updateUserSettings(L)).data&&(w("next","COMPLETED"),m.showNotification({type:"success",message:"Login Successful"}),s.push("/admin/dashboard")),$e.set("auth.token",l.data.token)}return!0}return r.value=!1,!0})}return(V,h)=>{const l=_("BaseMultiselect"),L=_("BaseInputGroup"),Y=_("BaseIcon"),Z=_("BaseButton"),Q=_("BaseWizardStep");return B(),k(Q,{title:V.$t("wizard.preferences"),description:V.$t("wizard.preferences_desc"),"step-container":"bg-white border border-gray-200 border-solid mb-8 md:w-full p-8 rounded w-full"},{default:d(()=>[I("form",{action:"",onSubmit:H(u,["prevent"])},[I("div",null,[I("div",ga,[n(L,{label:V.$t("wizard.currency"),error:e(i).currentPreferences.currency.$error&&e(i).currentPreferences.currency.$errors[0].$message,"content-loading":e(o),required:""},{default:d(()=>[n(l,{modelValue:e(t).currency,"onUpdate:modelValue":h[0]||(h[0]=P=>e(t).currency=P),"content-loading":e(o),options:e(g).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",placeholder:V.$tc("settings.currencies.select_currency"),invalid:e(i).currentPreferences.currency.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"]),n(L,{label:V.$t("settings.preferences.default_language"),error:e(i).currentPreferences.language.$error&&e(i).currentPreferences.language.$errors[0].$message,"content-loading":e(o),required:""},{default:d(()=>[n(l,{modelValue:e(t).language,"onUpdate:modelValue":h[1]||(h[1]=P=>e(t).language=P),"content-loading":e(o),options:e(g).languages,label:"name","value-prop":"code",placeholder:V.$tc("settings.preferences.select_language"),class:"w-full","track-by":"name",searchable:!0,invalid:e(i).currentPreferences.language.$error},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),I("div",va,[n(L,{label:V.$t("wizard.date_format"),error:e(i).currentPreferences.carbon_date_format.$error&&e(i).currentPreferences.carbon_date_format.$errors[0].$message,"content-loading":e(o),required:""},{default:d(()=>[n(l,{modelValue:e(t).carbon_date_format,"onUpdate:modelValue":h[2]||(h[2]=P=>e(t).carbon_date_format=P),"content-loading":e(o),options:e(g).dateFormats,label:"display_date","value-prop":"carbon_format_value",placeholder:V.$tc("settings.preferences.select_date_format"),"track-by":"display_date",searchable:"",invalid:e(i).currentPreferences.carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"]),n(L,{label:V.$t("wizard.time_zone"),error:e(i).currentPreferences.time_zone.$error&&e(i).currentPreferences.time_zone.$errors[0].$message,"content-loading":e(o),required:""},{default:d(()=>[n(l,{modelValue:e(t).time_zone,"onUpdate:modelValue":h[3]||(h[3]=P=>e(t).time_zone=P),"content-loading":e(o),options:e(g).timeZones,label:"key","value-prop":"value",placeholder:V.$tc("settings.preferences.select_time_zone"),"track-by":"key",searchable:!0,invalid:e(i).currentPreferences.time_zone.$error},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),I("div",fa,[n(L,{label:V.$t("wizard.fiscal_year"),error:e(i).currentPreferences.fiscal_year.$error&&e(i).currentPreferences.fiscal_year.$errors[0].$message,"content-loading":e(o),required:""},{default:d(()=>[n(l,{modelValue:e(t).fiscal_year,"onUpdate:modelValue":h[4]||(h[4]=P=>e(t).fiscal_year=P),"content-loading":e(o),options:e(g).fiscalYears,label:"key","value-prop":"value",placeholder:V.$tc("settings.preferences.select_financial_year"),invalid:e(i).currentPreferences.fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),n(Z,{loading:r.value,disabled:r.value,"content-loading":e(o),class:"mt-4"},{left:d(P=>[n(Y,{name:"SaveIcon",class:A(P.class)},null,8,["class"])]),default:d(()=>[x(" "+U(V.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled","content-loading"])])],32)]),_:1},8,["title","description"])}}},ba="/build/assets/crater-logo-c5521a16.png",$a={components:{step_1:Pe,step_2:Re,step_3:Qe,step_4:ta,step_5:ra,step_6:ia,step_7:pa,step_8:_a},setup(){let b=F("step_1"),z=F(1);const w=ve(),r=j();o();async function o(){let s=await r.fetchInstallationStep();if(s.data.profile_complete==="COMPLETED"){w.push("/admin/dashboard");return}let c=parseInt(s.data.profile_complete);c&&(z.value=c+1,b.value=`step_${c+1}`)}async function t(s){var g,a;let c={profile_complete:s};try{return await r.addInstallationStep(c),!0}catch(f){return((a=(g=f==null?void 0:f.response)==null?void 0:g.data)==null?void 0:a.message)==="The MAC is invalid."&&window.location.reload(),!1}}async function v(s){if(s&&!await t(s))return!1;z.value++,z.value<=8&&(b.value="step_"+z.value)}function q(s){}return{stepComponent:b,currentStepNumber:z,onStepChange:v,saveStepProgress:t,onNavClick:q}}},wa={class:"flex flex-col items-center justify-between w-full pt-10"},ha=I("img",{id:"logo-crater",src:ba,alt:"Crater Logo",class:"h-12 mb-5 md:mb-10"},null,-1);function ya(b,z,w,r,o,t){const v=_("BaseWizard");return B(),C("div",wa,[ha,n(v,{steps:7,"current-step":r.currentStepNumber,onClick:r.onNavClick},{default:d(()=>[(B(),k(se(r.stepComponent),{onNext:r.onStepChange},null,40,["onNext"]))]),_:1},8,["current-step","onClick"])])}const Sa=ue($a,[["render",ya]]);export{Sa as default};
